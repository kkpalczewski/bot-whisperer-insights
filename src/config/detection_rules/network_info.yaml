
- id: network_info
  name: Network Information
  codeName: network_info
  type: object
  code: |
    (() => {
      try {
        const connection = navigator.connection || {};
        const vpnPatterns = /datacenter|cloud|proxy|vpn|hosting/i;
        
        // Get IP info via WebRTC (if available)
        const hasWebRTC = !!(window.RTCPeerConnection || window.webkitRTCPeerConnection);
        
        return {
          connection: {
            effectiveType: connection.effectiveType || 'unknown',
            rtt: connection.rtt || 0,
            downlink: connection.downlink || 0,
            saveData: connection.saveData || false
          },
          webRTC: {
            available: hasWebRTC,
            protocol: window.location.protocol,
          },
          timing: {
            // Navigation timing data
            navigationStart: performance?.timing?.navigationStart || 0,
            loadEventEnd: performance?.timing?.loadEventEnd || 0,
            loadTime: performance?.timing?.loadEventEnd - performance?.timing?.navigationStart || 0
          }
        };
      } catch (e) {
        return {
          error: 'Failed to get network information',
          connection: {
            effectiveType: 'unknown',
            rtt: 0,
            downlink: 0,
            saveData: false
          }
        };
      }
    })()
  description: Enhanced network connection information including timing and WebRTC detection
  category: network
  outputs:
    connection:
      name: Connection Details
      type: object
      description: Network connection characteristics
      outputs:
        effectiveType:
          name: Connection Type
          type: string
          description: Network connection type (4g, 3g, 2g, slow-2g)
          abuse_indication:
            bot: Datacenter connections often show stable, high-bandwidth patterns unlike real users.
        rtt:
          name: Round Trip Time
          type: number
          description: Network round-trip time in milliseconds
          abuse_indication:
            bot: Extremely low or consistent RTT values can indicate datacenter proxies.
        downlink:
          name: Downlink Speed
          type: number
          description: Connection downlink speed in Mbps
          abuse_indication:
            bot: Unusually high or perfectly stable bandwidth can indicate automated environments.
        saveData:
          name: Data Saver
          type: boolean
          description: Whether data saver is enabled
    webRTC:
      name: WebRTC Information
      type: object
      description: WebRTC availability and protocol information
      abuse_indication:
        bot: Bots often disable WebRTC to prevent IP detection.
    timing:
      name: Navigation Timing
      type: object
      description: Page load timing metrics
      abuse_indication:
        bot: Bots often have unnaturally fast or consistent load times.

